# Энергопотребление Kolibri Chat

## Измерения
- **Методика**: мониторинг процесса `uvicorn` с помощью `psutil` во время 30-секундного прогона k6 (20 VU) против `/api/health`.
- **Длительность выборки**: 35.0 s
- **Количество сэмплов**: 70
- **Средняя загрузка CPU процесса**: 2.89%
- **Пиковая загрузка CPU процесса**: 10.00%
- **Среднее потребление памяти**: 58.5 MB RSS

## Оценка энергопотребления
- **Модель**: линейная интерполяция между простоем (30 W) и TDP (65 W) для 1U-сервера с 65 W CPU.
- **Расчётная средняя мощность**: 31.01 W
- **Потребление энергии за 35 s**: 0.30 Wh

## Рекомендации по снижению энергопотребления
1. **Снизить фоновые затраты FastAPI**: выключить автогенерацию OpenAPI и docs в продакшене, чтобы сократить инициализацию приложения.
2. **Увеличить эффективность кешей**: добавить кэширование ответов `/api/health` и других статичных эндпоинтов на уровне CDN/edge, чтобы уменьшить обращения к приложению.
3. **Оптимизировать контейнеризацию**: использовать `uvicorn --workers 1 --loop uvloop` для небольших узлов, чтобы уменьшить количество неактивных воркеров.
4. **Авто-масштабирование**: внедрить горизонтальное автоскейлинг с метриками CPU<20% и остановкой простаивающих экземпляров.
5. **Frontend**: продолжить ленивую загрузку тяжёлых модулей (`CommandMenu`, `RightDrawer`) и использовать prefetch на пользовательские действия, чтобы сократить CPU при первом рендере и снизить потребление энергии на клиентах.
