# Требования к данным для `NodeGraph`

Компонент визуализации топологии кластера использует данные телеметрии Колибри
о состоянии узлов и соединений. Теперь `NodeGraph` работает только с живыми
данными и ожидает, что бридж или API фронтенда передаст актуальный снимок
топологии без каких-либо моков или заглушек.

## Формат топологии

```ts
interface ClusterTopology {
  updatedAt: string; // ISO 8601, время обновления снимка
  nodes: ClusterNode[];
  links: ClusterLink[];
}

interface ClusterNode {
  id: string; // уникальный идентификатор узла в кластере
  name: string; // короткое имя для отображения
  role: "control" | "compute" | "storage" | "ingress" | "database";
  status: "online" | "offline" | "degraded"; // текущее состояние
  metrics?: {
    cpuLoad?: number; // 0..1, доля загруженности CPU
    memoryUsage?: number; // 0..1, доля использованной памяти
  };
  position: {
    x: number; // координата узла в плоскости визуализации (пиксели)
    y: number;
  };
}

interface ClusterLink {
  id: string; // уникальный идентификатор связи
  source: string; // id исходного узла
  target: string; // id целевого узла
  bandwidthGbps?: number; // пропускная способность канала
  latencyMs?: number; // задержка, миллисекунды
}
```

*Поля `metrics`, `bandwidthGbps` и `latencyMs` опциональны, однако их наличие
позволяет дополнительно подсвечивать состояние узлов и связи.*

## Обновление данных

1. Источник телеметрии должен поставлять актуальный снимок топологии в формате
   выше.
2. REST-эндпоинт `/telemetry/topology` (или другой прокси, настроенный в Kolibri)
   обязан возвращать описанный объект в формате JSON. Фронтенд автоматически
   запрашивает его при переходе на вкладку визуализации и при ручном обновлении.
3. Координаты `position` генерируются на стороне сервиса телеметрии или
   специализированного layout-алгоритма; компонент принимает их как есть.
4. Значения метрик ожидаются в диапазоне `0..1` и в интерфейсе отображаются в
   процентах.

## Следующие шаги интеграции

- Подключить реальный источник данных Kolibri и прокинуть топологию через
  эндпоинт `/telemetry/topology`, либо заменить его на потоковый канал при
  переходе на WebSocket/SSE.
- Добавить всплывающие подсказки с подробной диагностикой по наведению на
  узлы и связи.
- Реализовать подсветку критических узлов при деградации сервиса.
