# Kolibri OS Overview / Обзор Kolibri OS / Kolibri OS 概览

**Copyright (c) 2025 Кочуров Владислав Евгеньевич**

---

## 1. Mission / Миссия / 使命

Обеспечить автономный запуск ядра Kolibri на минимальном оборудовании без зависимости от полноценных ОС.

---

## 2. Boot Sequence / Последовательность загрузки / 启动流程

1. BIOS передаёт управление загрузчику `kolibri.asm` (512 байт, записываемому в MBR).
2. Загрузчик инициализирует видеорежим 80x25, выводит приветствие и находит секции ядра.
3. Загружает бинарник Kolibri Core в память, передаёт управление точке входа `kolibri_start`.
4. Ядро инициализирует RNG, формульный пул, геном и сетевой стек (при наличии драйверов).

---

## 3. Memory Map / Карта памяти / 内存布局

| Address | Description |
|---------|-------------|
| 0x0000:7C00 | Бут-сектор `kolibri.asm` |
| 0x0000:8000 | Таблица параметров (seed, node id) |
| 0x0010:0000 | Загружаемый бинарник `kolibri.bin` |
| 0x0020:0000 | Рабочая область ядра / стеки |

---

## 4. Configuration Block / Конфигурационный блок / 配置块

```
struct KolibriBootConfig {
    uint32_t seed;
    uint32_t node_id;
    uint16_t listen_port;
    uint16_t reserved;
};
```

Загрузчик заполняет структуру и передаёт адрес в регистре `SI` ядру.

---

## 5. Console Interface / Консольный интерфейс / 控制台接口

- Поддерживает команды REPL, аналогичные десктопной версии.
- Использует BIOS interrupt 0x10 для ввода/вывода.
- Буфер команд ограничен 128 символами; истории нет.

---

## 6. Build & Emulation / Сборка и эмуляция / 构建与仿真

1. Соберите ядро `make` → получите `build/kolibri_node`.
2. Сформируйте бинарник для прошивки `objcopy -O binary build/kolibri_node build/kolibri.bin`.
3. Ассемблируйте загрузчик `nasm -f bin kolibri.asm -o kolibri.img` (см. TODO).
4. Запустите `qemu-system-x86_64 -drive format=raw,file=kolibri.img`.

---

## 7. Roadmap / Дорожная карта / 路线图

- [ ] Автоматическая упаковка бинарника и загрузчика в `kolibri.sh`.
- [ ] Сетевой драйвер с поддержкой SLIP/UDP для обмена формулами прямо из Kolibri OS.
- [ ] Минимальный файловый слой для хранения `genome.dat` на RAM-диске.
- [ ] Интеграция с визуальным монитором через последовательный порт.

