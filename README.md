# Kolibri OS Prototype

Новое видение будущего.

## Быстрый старт

```bash
make
./kolibri.sh up
```

При первом запуске `kolibri.sh up` создаст файл `root.key` с уникальным
HMAC-ключом, который используется для подписи цифрового генома и пакетов роя.

### Запуск узла Kolibri

```bash
./build/kolibri_node --seed 42 --node-id 1 --listen 4050
```

После запуска откроется русскоязычный REPL с цифровой памятью и цифровым
геномом. Доступные команды:

- `:teach 2->5` — добавить обучающий пример для эволюции формул.
- `:ask 4` — применить текущий лучший ген к указанному входу.
- `:good` — поощрить последнюю формулу за корректный ответ.
- `:bad` — наказать последнюю формулу за ошибку или шум.
- `:tick [n]` — выполнить `n` поколений естественного отбора (по умолчанию 1).
- `:evolve [n]` — форсировать дополнительную эволюцию (по умолчанию 32).
- `:why` — вывести описание активного гена и сам десятичный код.
- `:canvas` — визуализировать фрактальную память цифровых импульсов.
- `:sync` — поделиться лучшим геном со случайным соседом.
- `:cluster list` — показать актуальный список соседей Kolibri Swarm.
- `:cluster broadcast` — разослать лучший ген всем соседям и в широковещание.
- `:cluster hello` — вручную отправить широковещательное приветствие.
- `:verify` — проверить целостность файла `genome.dat` перед продолжением.
- `:script lesson.ks` — выполнить сценарий KolibriScript из указанного файла.
- `:help` — краткий список команд, `:quit` — завершение работы узла.

Каждая команда транслируется в десятичные импульсы и записывается в цифровой
геном, обеспечивая воспроизводимый след принятия решений.

### Параметры CLI

- `--genome <путь>` — использовать указанный файл цифрового генома вместо
  значения по умолчанию `genome.dat`.
- `--verify-genome` — перед запуском выполняет криптографическую проверку
  выбранного файла генома. При успешной проверке запускается обычный цикл
  узла, при ошибке программа завершается с кодом 1.
- `--listen <порт>` — включить прослушивание бинарного протокола роя.
- `--peer <host:port>` — добавить статического соседа и мгновенно отправить ему приветствие.
- `--hmac-key <путь>` — указать файл с HMAC-ключом. Значение по умолчанию —
  `root.key` рядом с бинарником; файл создаётся автоматически скриптом
  `kolibri.sh up` и используется всеми узлами кластера.

### Запуск локального роя

Скрипт `scripts/run_cluster.sh` автоматически собирает бинарники и поднимает
несколько узлов на одной машине. Пример запуска трёх узлов с базовым портом
4100 и временем жизни роя 120 секунд:

```bash
./scripts/run_cluster.sh -n 3 -b 4100 -d 120
```

Для непрерывной работы передайте `-d 0`. Каждый узел записывает цифровой
геном и журнал в каталог `build/cluster`, а обнаружение и обмен генами
выполняются через широковещательные приветствия и Kolibri Swarm Protocol.

### Полный технический прогон

Чтобы воспроизвести весь конвейер — сборку ядра, тесты, создание артефактов
`kolibri.wasm` и `kolibri.iso`, а также короткий запуск роя — используйте
скрипт `scripts/run_all.sh`:

```bash
./scripts/run_all.sh
```

По умолчанию будет поднят трёхузловой кластер на 30 секунд. Флаги `-n` и `-d`
позволяют скорректировать размер и длительность роя, а ключи `--skip-wasm`,
`--skip-iso` и `--skip-cluster` выключают отдельные стадии при необходимости.

## Тесты и техническая готовность

```bash
make check
```

Цель `check` последовательно выполняет юнит-тесты (`ctest`),
собирает загрузочный образ Kolibri OS и генерирует WebAssembly-модуль
`build/wasm/kolibri.wasm`, контролируя, чтобы его размер не превышал 1 МБ.

### Избирательные цели

```bash
make test   # только C-тесты
make iso    # только kolibri.iso
make wasm   # только kolibri.wasm
```

### Зависимости инструментов

Для сборки ISO понадобятся `nasm`, `grub-mkrescue`, `xorriso` и либо
кросс-компилятор `i686-elf-gcc`, либо системный `gcc` с поддержкой `-m32`.
Пример для Debian/Ubuntu:

```bash
sudo apt-get update
sudo apt-get install nasm grub-pc-bin xorriso gcc-multilib
```

Скрипт `scripts/build_iso.sh` автоматически проверяет доступность
инструментов и завершится с подсказкой, если окружение настроено не полностью.

Для генерации `kolibri.wasm` необходим Emscripten (`emcc`). Скрипт
`scripts/build_wasm.sh` работает с установленным SDK (например, через
`emsdk install latest && emsdk activate latest`) и формирует артефакт
`build/wasm/kolibri.wasm`, а также файл с контрольной суммой.

## Документация

- [Индекс документации / Documentation Index](docs/README.md)
- [Интегрированный прототип ИИ «Колибри»](docs/kolibri_integrated_prototype.md)
- [Master Prompt for the Materialization of Kolibri AI Ecosystem](docs/master_prompt.md)
- [Архитектура Kolibri](docs/architecture.md)
- [Руководство разработчика](docs/developer_guide.md)
- [Протокол роя](docs/swarm_protocol.md)
- [Слой десятичного мышления](docs/decimal_cognition.md)
- [Эволюция формул](docs/formula_evolution.md)
- [Цифровой геном Kolibri](docs/genome_chain.md)
- [Kolibri OS](docs/kolibri_os.md)
- [Веб-интерфейс и WASM-мост](docs/web_interface.md)
- [Нейронный телескоп Kolibri](docs/neural_telescope.md)
- [Язык KolibriScript](docs/kolibri_script.md)
- [Релизные заметки](docs/release_notes.md)
- [Научная повестка](docs/research_agenda.md)
